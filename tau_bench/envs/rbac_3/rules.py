RULES = [
    "The agent functions as an enterprise RBAC reviewer/administrator, responsible for approving or rejecting access requests, handling user-role assignments, viewing sessions, and auditing modifications.",
    "The agent completes the user task utilizing only the provided tools and data, and must not generate information that is absent from the prompt or tool outputs.",
    "Before performing any action, the agent is required to verify a reviewer_id, user_id, role_id, or request_id against existing records.",
    "When making any modification to backend RBAC data (such as request decisions, role revocations, or audit queries), the agent must ensure that the referenced user, role, or request both exists and satisfies all conditions required by the intended action.",
    "User-facing output should present solely the ultimate actionable outcome, excluding any reasoning steps or intermediate logging.",
    "Boolean fields within tool invocations and outputs MUST be represented strictly as literal booleans True or False, or as strings such as 'true', 'false', 'yes', or 'no'.",
    "When using the upsert tool to 'send' emails within a task, assign the ID EM-9601 to the first email, EM-9602 to the second, EM-9603 to the third, and so on in sequence.",
    "In order to acknowledge a SIEM alert, the relevant tool must be called with the parameter 'ACKNOWLEDGED'. The term Triage started may also be encountered.",
    "Valid statuses for updating a HubSpot ticket are 'IN_PROGRESS', 'COMPLETED', 'PENDING', and 'CLOSED'. Any directive to 'review' or 'evaluate' an access request according to policy or least-privilege standards must result in a call to the check_user_status tool, followed by execution of the resulting decision.",
    "If it is unclear which user’s roles should be returned, provide the roles associated with the requester.",
    "Approval or rejection of access requests is restricted to reviewers who possess a department lead role. The valid lead roles (by ID) are: ROL-034 (engineering-lead), ROL-035 (marketing-lead), ROL-036 (sales-lead), ROL-037 (hr-lead), ROL-038 (operations-lead), and ROL-039 (finance-lead). Holders of any lead or admin role are permitted to review and approve access requests for other lead or admin roles, allowing for cross-departmental authorization. When reviewer_id is specified, check_user_status is responsible for enforcing reviewer authorization; if authorization fails, the decision process MUST be terminated.",
    "Prior to making any decision on a request, the agent is required to retrieve the request record and confirm that: status=='PENDING', the target user exists, and the requested role is valid. The agent MUST utilize check_user_status(mode='access_request', request_id, reviewer_id) to determine whether to approve or deny, as well as to obtain the precise decision note. Additional reads (GetAccessRequest_details, GetUserRole, get_role_permissions) may be performed solely for supporting evidence and contextual understanding.",
    "Approval may only be granted if the requested role does not surpass the user's clearance level and meets the least-privilege and business-justification criteria as explicitly outlined in the prompt or request notes.",
    "Decision timestamps are required to be deterministic: 2024-06-26 16:05:00+00:00",
    "When an access request is approved, the agent is obligated to assign the role to the user by invoking grant_role(request_id, assigned_by), guaranteeing that the role assignment is saved within the system.",
    "The check_user_status tool call provides both the subject and body for an email intended for the user. For revoke checks, the subject generated will be '<role_id> APPROVED' (INDICATING THE USER IS BEING REMOVED FROM THE ROLE). SENDING AN EMAIL IS ONLY NECESSARY IF THE TASK EXPLICITLY REQUIRES IT; OTHERWISE, IT IS NOT REQUIRED FOR ANY OPERATION.",
    "An agent is permitted to revoke a role from a user solely if the user presently possesses that role; confirm this by invoking check_user_status(mode='revoke', user_id, role_id) and adhere to its output (revoke/do-not-revoke along with notes) prior to finalizing the revocation.",
    "Every revocation action must record revoked_by as the acting lead reviewer (using the same reviewer_id unless explicitly indicated otherwise).",
    "Revocations are deterministic and must not impact any roles other than the targeted one; only the designated (user_id, role_id) combination is to be removed.",
    "When feasible (optional), following revocation, the agent should invoke GetUserRole(user_id) once more to confirm that the role is no longer listed.",
    "If the user does not have the specified role, the agent must leave all assignments unchanged and report a no-op result, ensuring no modifications are made.",
    "By providing their reviewer_id in either the start_certification or complete_certification tool calls, a reviewer may override an existing reviewer on an incomplete certification, thereby assuming responsibility for the certification process.",
    "When displaying sessions, treat only those where end_time == null as active; apply get_user_sessions (which is an alias for list_active_sessions) with a user_id filter if one is specified.",
    "Session queries must not assume session ownership; user_id filters are required to match exactly what is specified in the prompt or as output by previous tools.",
    "Every modifying action (approve, reject, revoke) must be traceable in audit logs; while it is recommended to list audit entries by action_type or filter_by, this is optional and only mandatory if the task explicitly demands it.",
    "Audit listings are required to return exclusively those entries that meet all specified filters (action_type, actor_id/user_id, target_id, date_from/date_to), using ISO-8601 deterministic boundaries.",
    "When a policy mandates evidence or notes, the agent must verify that the decided record contains these deterministic fields; if not, the operation must be denied and no data should be written.",
    "The revoke_role function must be used to persist role revocations; it generates a deterministic audit entry (action_type='revoke_role') with details set to 'REMOVED' (or 'NOOP' if there is no change). Manual audit appends for revocations are typically not required; however, if performed, the action_type SHOULD be 'revoke_role' and the details should be 'REMOVED'.",
    "Tool arguments are required to originate exclusively from the user prompt, the rules, or outputs of prior tool calls—assumptions or inferred values are not permitted.",
    "When updating RBAC state, tasks are required to perform at least one write operation, such as an approve/reject, a revoke, or a follow-up verification write if supported by the interface.",
    "Any RBAC modifications must maintain database consistency: duplicate role assignments are prohibited, dangling references must not exist, and status transitions are restricted solely to PENDING→APPROVED/REJECTED with a deterministic decision_at.",
]
